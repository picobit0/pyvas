# Конфигурационное управление/Практика 3
## Низамутдинов Степан, ИКБО-20-24
### Вариант 16

## Запуск
Запуск ассемблера:
```
py assembler.py --source <файл с исходным кодом> --output <файл вывода>
```

Запуск интерпретатора:
```
py interpreter.py --code <файл с двоичным кодом> --dump <файл вывода дампа>
```

## Язык ассемблера (.pvs)
Структура одной строки файла:
```
<команда> <аргумент> [: <комментарий>]
```
Пример файла:
```
LD 123 : комментарий к операции
rd 0

Wr 2 :
```
Доступные команды:
* `LD` - загрузка константного аргумента в стек
* `RD` - загрузка значения из памяти в стек
* `WR` - запись значения из стека в память
* `SG` - запись результата операции sign() от значения на стеке в память

Запись команд допускается в любом регистре.

Агрумент представляет собой целое десятичное число.

Все символы строки после `:` считаются частью комментария и игнорируются.
Пустые строки и дополнительные пробелы также игнорируются.
# Этап 3
## Список изменений:
Добавлен интерпретатор двоичного файла.

Аргументы командной строки:
* `-c` | `--code` - путь к файлу с двоичным кодом
* `-d` | `--dump` - путь к файлу вывода дампа памяти (.csv)
* `-r` | `--range` - область дампа памяти (отрезок вида `n-m`)
## Демонстрация работы:
Исходный код, копирующий массив из 6 элементов:
```
: загрузка массива [1, 2, 3, 4, 39, 48] в ячейки памяти 0-5
LD 1
WR 0

LD 2
WR 1

LD 3
WR 2

LD 4
WR 3

LD 39
WR 4

LD 48
WR 5

: копирование массива из памяти в стек
LD 0
RD 5

LD 1
RD 3

LD 3
RD 0

LD 1
RD 1

LD 0
RD 1

LD 0
RD 0

: запись массива из стека в ячейки памяти 7-12
WR 7
WR 8
WR 9
WR 10
WR 11
WR 12
```
Компиляция и запуск программы в интерпретаторе:
```console
$ py assembler.py -s tests/array-copy.pvs -o tests/array-copy.bin
```
```
"tests/array-copy.pvs" parsed successfully
"tests/array-copy.pvs" assembled into "tests/array-copy.bin" (102 bytes)
```
```console
$ py interpreter.py -c tests/array-copy.bin -d tests/dump.csv -r 0-16
```
```
"tests/array-copy.bin" read successfully, starting execution
Execution finished successfully
Saving memory dump to "tests/dump.csv"
Memory dump saved
```
Содержимое дампа памяти:
```csv
1,2,3,4,39,48,0,1,2,3,4,39,48,0,0,0,0
```

# Этап 2
## Список изменений:
Добавлена сборка программы в двоичный файл.

Добавлен вывод двоичного представления в режиме тестирования.
## Демонстрация работы:
```console
$ py assembler.py -s tests/test1.pvs -o tests/output.bin -t
```
```
"tests/test1.pvs" parsed successfully
"tests/test1.pvs" assembled into "tests/output.bin" (13 bytes)
Binary assembly result:
0xBF 0x17 0x00 0x00 0x8D 0x07 0x00 0xE4 0x3E 0x00 0x5D 0x7B 0x00
```

# Этап 1
## Список изменений:
Добавлены аргументы командной строки для ассемблера:
* `-s` | `--source` - путь к файлу с исходным кодом (.pvs)
* `-o` | `--output` - путь к двоичному файлу вывода
* `-t` | `--test` - режим тестирования

Добавлен режим тестирования, выводящий промежуточное представление кода
## Демонстрация работы:
Тестовый файл с исходным кодом:
```
LD 94  : загузка константы
RD 30  : чтение из памяти
WR 251 : запись в память
SG 493 : взятие знака
```
Тестирование ассемблера:
```console
$ py assembler.py -s tests/test1.py -t
```
```
"tests/test1.pvs" parsed successfully
Intermediate representation:
(63, 94)
(13, 30)
(36, 251)
(29, 493)
```